/* Form Validate 0.1 under Angular
Requirements
	* jQuery v1.11.3 | (c) 2005, 2015 jQuery Foundation, Inc. | jquery.org/license
	* Bootstrap v3.3.4 (http://getbootstrap.com)
(c) 2006-2015 Memobit.ro
License: MIT */
"use strict";angular.module("formValidate",[]).directive("formValidate",function(){return{restrict:"A",scope:!1,controller:function(){},link:function(e,a){e.FV={errors:{header:{},popup:{}}},e.FV.init=function(){if("undefined"==typeof $)return e.FV.hasJquery=!1,e.FV.log("Dependency requirement: JQuery."),!1;e.FV.hasJquery=!0,e.FV.hasJquery&&$(document).keyup(function(a){27==a.keyCode&&"block"==$(".form-validate-popup-fader").css("display")&&e.FV.errors.popup.hide()}),a[0].onsubmit=function(a){return e.FV.validate(a),!1};for(var r=0;r<a[0].childElementCount;r++)if("undefined"!=typeof a[0][r])if("SELECT"==a[0][r].nodeName){var t=function(r){a[0][r].onchange=function(a){e.FV.validate(a)}};t(r)}else if("INPUT"==a[0][r].nodeName&&"radio"==a[0][r].type){var s=function(r){a[0][r].onclick=function(a){e.FV.validate(a)}};s(r)}else{var o=function(r){a[0][r].onblur=function(a){e.FV.validate(a)}};o(r)}},e.FV.getValidationRules=function(e){for(var a=[],r=e.target,t="submit"==e.type?r.childElementCount:1,s=0;t>s;s++){var o="submit"==e.type?r[s]:r,l=null,n=null,i=null;if("submit"!=e.type||"undefined"!=typeof r[s]){for(var d=0;d<o.attributes.length;d++)"validate"==o.attributes[d].name&&(i=o.attributes[d].value),"validate-message"==o.attributes[d].name&&(l=o.attributes[d].value),"ng-model"==o.attributes[d].name&&(n=o.attributes[d].value);if(null!=i){a[s]={message:null!=l?l:n,ngModel:n,value:o.value,error:null,validations:[],nodeName:o.nodeName,type:o.type},i=-1!=i.indexOf(",")?i.split(","):[i];for(var d=0;d<i.length;d++)if(-1!=i[d].indexOf(":")){var u=i[d].split(":");a[s].validations[u[0]]=u[1]}else a[s].validations[i[d]]=null}}}return a},e.FV.validate=function(a){var r=e.FV.getValidationRules(a);if(void 0==r)return!1;var t="submit"==a.type?a.target:[a.target],s="submit"==a.type?a.target.attributes:a.target.form.attributes,o="";for(var l in s)"form-validate"==s[l].nodeName&&(o=s[l].value);for(var n in r){r[n].value=t[n].value,$(t[n]).parent().find(".noticeError, .noticeSuccess").each(function(){$(this).remove()}),$(t[n]).parent().parent().removeClass("has-success has-error"),r[n].error=null;var i="";for(var d in r[n].validations)switch(d){case"mandatory":switch(r[n].nodeName){case"SELECT":0==e[r[n].ngModel]&&(i=r[n].message+" field is mandatory",e.FV.message(i,t[n]),r[n].error=i);break;case"INPUT":switch(r[n].type){case"text":case"password":e.FV.empty(e[r[n].ngModel])&&(i=r[n].message+" field is mandatory",e.FV.message(i,t[n]),r[n].error=i);break;case"radio":e.FV.empty(e[r[n].ngModel])&&(i=r[n].message+" field is mandatory",e.FV.message(i,t[n],1),r[n].error=i);break;default:e.FV.log("Unknown object subtype or unallowed object.")}break;case"TEXTAREA":e.FV.empty(e[r[n].ngModel])&&(i=r[n].message+" field is mandatory",e.FV.message(i,t[n]),r[n].error=i);break;default:e.FV.log("Unknown object type "+r[n].nodeName+".")}break;case"minlength":e.FV.empty(e[r[n].ngModel])||null!=r[n].error||r[n].value.length<r[n].validations[d]&&(i=r[n].message+" must have at least "+r[n].validations[d]+" characters",e.FV.message(i,t[n]),r[n].error=i);break;case"maxlength":e.FV.empty(e[r[n].ngModel])||null!=r[n].error||r[n].value.length>r[n].validations[d]&&(i=r[n].message+" must have at most "+r[n].validations[d]+" characters",e.FV.message(i,t[n]),r[n].error=i);break;case"min":e.FV.empty(e[r[n].ngModel])||null!=r[n].error||parseFloat(r[n].value)<r[n].validations[d]&&(i=r[n].message+" must be at least "+r[n].validations[d],e.FV.message(i,t[n]),r[n].error=i);break;case"max":e.FV.empty(e[r[n].ngModel])||null!=r[n].error||parseFloat(r[n].value)>r[n].validations[d]&&(i=r[n].message+" must be at most "+r[n].validations[d],e.FV.message(i,t[n]),r[n].error=i);break;case"integer":e.FV.empty(e[r[n].ngModel])||null!=r[n].error||parseInt(r[n].value)!=r[n].value&&(i=r[n].message+" must be an integer number",e.FV.message(i,t[n]),r[n].error=i);break;case"float":case"double":e.FV.empty(e[r[n].ngModel])||null!=r[n].error||parseFloat(r[n].value)!=r[n].value&&(i=r[n].message+" must be a float (double) number",e.FV.message(i,t[n]),r[n].error=i);break;case"web":if(!e.FV.empty(e[r[n].ngModel])&&null==r[n].error){var u=/^(https?:\/\/)?([\da-z\.-]+)\.([a-z\.]{2,6})([\/\w \.-]*)*\/?$/;u.test(r[n].value)||(i=r[n].message+" is not a valid web address",e.FV.message(i,t[n]),r[n].error=i)}break;case"email":if(!e.FV.empty(e[r[n].ngModel])&&null==r[n].error){var u=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;u.test(r[n].value)||(i=r[n].message+" is not a valid email address",e.FV.message(i,t[n]),r[n].error=i)}break;case"ip":if(!e.FV.empty(e[r[n].ngModel])&&null==r[n].error){var u=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;u.test(r[n].value)||(i=r[n].message+" is not a valid IP address",e.FV.message(i,t[n]),r[n].error=i)}break;case"match":if("submit"==a.type&&!e.FV.empty(e[r[n].ngModel])&&null==r[n].error){var m=r[n].validations.match,p=null,c=null;for(var f in r)r[f].ngModel==m&&(p=r[f].value,c=r[f].message);p!=r[n].value&&(i=r[n].message+" must match "+c,e.FV.message(i,t[n]),r[n].error=i)}break;case"must_have_specials":if(!e.FV.empty(e[r[n].ngModel])&&null==r[n].error){for(var v="~`!@#$%^&*()_-+=,<.>/?",g=!1,f=0;f<v.length;f++)-1!=r[n].value.indexOf(v.charAt(f))&&(g=!0);g||(i=r[n].message+" must contain special characters",e.FV.message(i,t[n]),r[n].error=i)}break;default:e.FV.log("Unknown rule "+d)}}var h=[],b=!1;for(var n in r)if(null==r[n].error){var V="submit"==a.type?a.target[n]:a.target;switch(r[n].nodeName){case"SELECT":case"TEXTAREA":e.FV.message(null,V);break;case"INPUT":switch(r[n].type){case"text":case"password":e.FV.message(null,V);break;case"radio":e.FV.message(null,V,1);break;default:e.FV.log("Unknown object subtype or unallowed object.")}break;default:e.FV.log("Unknown object type "+r[n].nodeName+".")}}else h.push({error:r[n].error}),b=!0;if("submit"==a.type){var y=[];for(n in h){var F=!1;for(d in y)y[d].error==h[n].error&&(F=!0);F||y.push({error:h[n].error})}h=y,"header"==o&&(h.length>0?e.FV.errors.header.show(t,h):e.FV.errors.header.hide(t)),"popup"==o&&(h.length>0?($(".form-validate-popup").slideDown(),e.FV.errors.popup.show(t,h)):e.FV.errors.popup.hide(t)),e.onSubmit(b?!1:!0),e.$apply()}return!1},e.FV.message=function(a,r,t){var s="";for(var o in r.form)void 0!=r.form.attributes[o]&&(void 0!=r.form.attributes[o]["form-validate"]&&(s=r.form.attributes[o]["form-validate"]),void 0!=r.form.attributes[o].nodeName&&"form-validate"==r.form.attributes[o].nodeName&&(s=r.form.attributes[o].value));if("inline"==s){switch(t=void 0==t?0:t){case 0:var l=r.clientWidth+(null==a?24:14),n=8,i="top:0px;";break;case 1:var l=r.clientWidth+$(r).next().width()+(null==a?25:26),n=4,i="top:initial;";break;default:var l=r.clientWidth+(null==a?24:26),n=8,i="top:0px;";e.FV.log("After element "+t+" not allowed.")}if(null==a)var d='<div style="left: '+l+"px; "+i+"  padding-top:"+n+'px;" class="glyphicon glyphicon-ok noticeSuccess"></div>';else var d='							<div class="noticeError" style="left: '+l+"px; "+i+'">								<span class="glyphicon glyphicon-remove"></span> 								'+a+".							</div>";var u=null==a?"has-success":"has-error";switch(angular.element(r).parent().parent().removeClass("has-success has-error").addClass(u),t){case 0:angular.element(r).after(d),e.FV.hasJquery?$(r).next().fadeIn():angular.element(r).next().css("display","block");break;case 1:angular.element(r).next().after(d),e.FV.hasJquery?($(r).next().next().fadeIn(),$(r).next().next().css("display","inline-block")):angular.element(r).next().next().css("display","inline-block");break;default:e.FV.log("After element "+t+" not allowed.")}}},e.FV.empty=function(e){return"undefined"==typeof e||""==e?!0:!1},e.FV.log=function(e){console.log("Form Validate :: "+e)},e.FV.errors.header.show=function(e,a){var r="";for(var t in a)r+='<li style="padding-left:20px;">'+a[t].error+"</li>";var s,o=!1;$(e).find(".form-validate-errors").each(function(){s=$(this),""==$(this).html()&&(o=!0)});var l='					<div class="alert alert-danger form-validate-errors-block" '+(o?'style="display:none;"':"")+" >						The following errors where encountered:<br /><br />						<ul>							"+r+"						</ul>						<br />Please verify!					</div>				";$(s).html(l),"none"==$(s).css("display")&&$(s).slideDown();var n;$(e).find(".form-validate-errors-block").each(function(){n=$(this)}),"none"==$(n).css("display")&&$(n).slideDown()},e.FV.errors.header.hide=function(e){$(e).find(".form-validate-errors").each(function(){$(this).slideUp()})},e.FV.errors.popup.show=function(e,a){var r="";for(var t in a)r+='<li style="padding-left:20px;">'+a[t].error+"</li>";var s='					<div class="alert alert-danger" ng-show="FV.errors.length > 0">						<div class="glyphicon glyphicon-remove form-validate-btnClose" onclick="$(this).parent().parent().slideUp();$(\'.form-validate-popup-fader\').slideUp(function(){ $(\'.form-validate-popup-fader\').remove(); });"></div>						The following errors where encountered:<br /><br />						<ul>							'+r+"						</ul>						<br />Please verify!					</div>				";$(e).find(".form-validate-popup").each(function(){$(this).html(s)}),$("body").append('<div class="form-validate-popup-fader"></div>'),$(".form-validate-popup-fader").slideDown()},e.FV.errors.popup.hide=function(){$(".form-validate-popup").slideUp(),$(".form-validate-popup-fader").slideUp(function(){$(".form-validate-popup-fader").remove()})},e.FV.init()}}});